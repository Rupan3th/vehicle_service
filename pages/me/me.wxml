<!--pages/me/me.wxml-->
<view class="my-container">
  <view class="userinfo" style="height: calc(100% - 85px - env(safe-area-inset-bottom));">
    <button wx:if="{{!hasUserInfo && canIUse}}" open-type="getUserInfo" bindgetuserinfo="getUserInfo"> 获取头像昵称 </button>
    <block wx:else>   
      <view class="avata-pan">
        <image bindtap="avatarpreview" class="userinfo-avatar" src="{{avatar}}" mode="cover" data-file="{{avatar}} "></image>
        <view class="nickname-pan">
          <view><text>账号信息</text></view>
          <view><text class="userinfo-nickname">{{nick}}</text></view>
          <view><text>{{mobile}}</text></view>
        </view>
      </view> 
      
      <view wx:if="{{showIntegral}}" class="coin-pan">
        <image class="coinboximg" src="../../image/box_icon.png" ></image>
        <view wx:if="{{!bindBank}}" style="display: flex; align-items:center; margin-left:8px;">
          <text style="color: #999999; font-size:16px;">请先绑定银行卡才可获得积分</text>
        </view>
        
        <view wx:if="{{!!bindBank}}" class="coinamount-pan" style="display: flex;" bindtap="bindViewTap">
          <view>
            <view><text>已获积分</text></view>
            <view><text class="userinfo-nickname" style="color: #4DB628;">{{integral}}</text></view>     
          </view>                
        </view>
      </view>

      <view class="card-pan" bindtap="gotoBindCard">
        <image style="width:40px; height:30px; margin-left:17px;" src="../../image/card_icon.png" ></image>
        <text style="margin-left: 10px; color: #333333; font-size: 14px;">银行卡</text>
        <view style="margin-left: auto; margin-right: 12px; display:flex; align-items:center;">   
          <text class="card-connect" style="background-color: {{bindBank ? '#d8d8d8' : '#CC0000'}};">{{bindBank ? '已绑定' : '未绑定'}}</text>
          <image style="width:12px; height:22px; margin-left:14px;" src="../../image/next.png" ></image>   
        </view>                                        
        
      </view>
    </block>
  </view>
  <tabbar activeIndex="2"></tabbar>
</view>